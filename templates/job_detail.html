{% extends "base.html" %}
{% block content %}
<div class="row">
  <div class="col-md-8">
    <h2>{{ job.job_title }}</h2>
    <p class="text-muted">{{ job.company }} â€” {{ job.location or "N/A" }}</p>
    <p><strong>Salary:</strong> {{ job.salary or "N/A" }}</p>
    <hr>
    <p>{{ job.description }}</p>

    {% if current_user.is_authenticated %}
      {% if job.posted_by_id == current_user.id or current_user.is_admin %}
        <div class="mt-3">
          <a href="{{ url_for('edit_job', job_id=job.id) }}" class="btn btn-outline-secondary">Edit</a>
          <form method="post" action="{{ url_for('delete_job', job_id=job.id) }}" style="display:inline;" onsubmit="return confirm('Delete this job?');">
            <button class="btn btn-danger">Delete</button>
          </form>
        </div>
      {% else %}
        {% if applied %}
          <div class="alert alert-info mt-3">You have already applied to this job.</div>
        {% else %}
          <a href="{{ url_for('apply', job_id=job.id) }}" class="btn btn-primary mt-3">Apply Now</a>
        {% endif %}
      {% endif %}
    {% else %}
      <p class="mt-3">Please <a href="{{ url_for('login') }}">log in</a> to apply.</p>
    {% endif %}
  </div>

  <div class="col-md-4">
    <div class="card p-3">
      <h5>Job Info</h5>
      <p><strong>Company:</strong> {{ job.company }}</p>
      <p><strong>Posted:</strong> {{ job.created_at.strftime("%d %b %Y") }}</p>
      <p><strong>Location:</strong> {{ job.location or "N/A" }}</p>
      <p><strong>Type:</strong> {{ job.job_type or "N/A" }}</p>
    </div>
  </div>
</div>
{% endblock %}
